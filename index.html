<!--
Este archivo `index.html` es la p√°gina principal de la aplicaci√≥n web del gimnasio PowerGym.
Sirve como el punto de entrada para los usuarios, presentando la estructura b√°sica de la interfaz
y la navegaci√≥n principal. Incluye la cabecera, el men√∫ de navegaci√≥n con opciones como "Mi Fitness",
"Mi Actividad" y "M√°s", √°reas de contenido din√°mico que se cargar√°n con informaci√≥n espec√≠fica,
un pie de p√°gina y la integraci√≥n de un chatbot.

Aunque este archivo HTML es est√°tico, la informaci√≥n que se muestra en las secciones din√°micas (como clases, rese√±as, entrenadores y reservas)
se obtiene de la base de datos. Esto se logra a trav√©s de scripts JavaScript que realizan peticiones as√≠ncronas (AJAX) a archivos PHP
ubicados en la carpeta `api/` (espec√≠ficamente `api/index.php`) y otros controladores PHP. Estos scripts PHP son los que interact√∫an
directamente con la base de datos para recuperar los datos reales y enviarlos al navegador para su visualizaci√≥n.
-->
<!DOCTYPE html> <!-- Define el tipo de documento como HTML5 -->
<html lang="es"> <!-- El idioma principal del documento es espa√±ol -->
<head>
    <meta charset="UTF-8"> <!-- Define la codificaci√≥n de caracteres como UTF-8 -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- Asegura que la p√°gina se vea bien en todos los dispositivos -->
    <title>PowerGym - Tu Gimnasio</title> <!-- T√≠tulo de la p√°gina que aparece en la pesta√±a del navegador -->
    <link rel="stylesheet" href="cs/estilos.css"> <!-- Enlaza la hoja de estilos principal -->
    <!-- Chatbot CSS -->
    <link rel="stylesheet" href="chatbot/css/estilos.css"> <!-- Enlaza la hoja de estilos espec√≠fica para el chatbot -->
</head>
<body>
    <!-- Contenedor para la animaci√≥n de fondo -->
    <div class="background-animation"></div>
    
    <!-- Cabecera de la p√°gina -->
    <header class="header">
        <!-- Secci√≥n del logo -->
        <div class="logo">
            <h1>PowerGym</h1>
            <p>Tu fuerza, nuestro compromiso</p>
        </div>
        <!-- Botones de la cabecera para iniciar/cerrar sesi√≥n -->
        <div class="header-buttons">
            <!-- Bot√≥n para iniciar sesi√≥n, visible para usuarios no autenticados -->
            <a href="login.php?action=login" id="login-button" class="login-btn">Iniciar Sesi√≥n</a>
            <!-- Secci√≥n para usuarios autenticados, oculta por defecto -->
            <div id="logged-in-section" style="display: none;">
                <a href="#" id="logout-btn" class="login-btn">Cerrar Sesi√≥n</a>
                <span id="welcome-message"></span> <!-- Mensaje de bienvenida para el usuario -->
            </div>
        </div>
        <!-- Contenedor para mostrar mensajes generales en la p√°gina -->
        <div id="page-message" class="hidden"></div>
    </header>

    <!-- Contenido principal de la p√°gina -->
    <main class="main-container">
        <!-- Men√∫ de navegaci√≥n principal -->
        <nav class="main-menu">
            <button class="menu-item" id="mi-fitness">
                <div class="menu-icon">üí™</div>
                <span>Mi Fitness</span>
            </button>
            <button class="menu-item" id="mi-actividad">
                <div class="menu-icon">üèÉ</div>
                <span>Mi Actividad</span>
            </button>
            <button class="menu-item" id="mas">
                <div class="menu-icon">‚öôÔ∏è</div>
                <span>M√°s</span>
            </button>
        </nav>

        <!-- √Årea donde se muestra el contenido principal y los submen√∫s -->
        <section class="content-area">
            <!-- Mensaje de bienvenida inicial -->
            <div class="welcome-message">
                <h2>Bienvenido a PowerGym</h2>
                <p>Selecciona una opci√≥n del men√∫ para comenzar</p>
            </div>

            <!-- Submen√∫ para "Mi Fitness", oculto por defecto -->
            <div class="submenu hidden" id="fitness-submenu">
                <h3>Mi Fitness</h3>
                <div class="circle-menu">
                    <div class="circle-item" data-option="clases">
                        <div class="circle-icon">üèãÔ∏è</div>
                        <span>Clases</span>
                    </div>
                    <div class="circle-item" data-option="entrenadores">
                        <div class="circle-icon">üë®‚Äçüè´</div>
                        <span>Entrenadores</span>
                    </div>
                    <a href="dietas.php" class="circle-item" data-option="dieta">
                        <div class="circle-icon">ü•ó</div>
                        <span>Dieta</span>
                    </a>
                </div>
            </div>

            <!-- Submen√∫ para "Mi Actividad", oculto por defecto -->
            <div class="submenu hidden" id="actividad-submenu">
                <h3>Mi Actividad</h3>
                <div class="circle-menu">
                    <div class="circle-item single-circle" data-option="reservas">
                        <div class="circle-icon">üìÖ</div>
                        <span>Reserva tus Clases</span>
                    </div>
                </div>
            </div>

            <!-- Submen√∫ para "M√°s", oculto por defecto -->
            <div class="submenu hidden" id="mas-submenu">
                <h3>M√°s Opciones</h3>
                <div class="circle-menu">
                    <a href="testimonios.php" class="circle-item-link">
                        <div class="circle-item" data-option="rese√±as">
                            <div class="circle-icon">‚≠ê</div>
                            <span>Rese√±as</span>
                        </div>
                    </a>
                    <a href="promociones.php" class="circle-item-link">
                        <div class="circle-item" data-option="notificaciones">
                            <div class="circle-icon">üîî</div>
                            <span>Notificaciones</span>
                        </div>
                    </a>
                </div>
            </div>
            
            <!-- Contenedor para el contenido que se carga din√°micamente (clases, rese√±as, etc.) -->
            <div id="dynamic-content" class="hidden">
                <!-- Secci√≥n para mostrar las clases -->
                <div id="clases-content" class="dynamic-section hidden">
                    <h3>Nuestras Clases</h3>
                    <p>Aqu√≠ se mostrar√° la informaci√≥n de las clases.</p>
                </div>
                <!-- Secci√≥n para mostrar las rese√±as -->
                <div id="rese√±as-content" class="dynamic-section hidden">
                    <h3>Rese√±as de Clientes</h3>
                    <p>Aqu√≠ se mostrar√°n las rese√±as.</p>
                </div>
                <!-- Secci√≥n para mostrar los entrenadores -->
                <div id="entrenadores-content" class="dynamic-section hidden">
                    <h3>Nuestros Entrenadores</h3>
                    <p>Aqu√≠ se mostrar√° la informaci√≥n de los entrenadores.</p>
                </div>
                <!-- Secci√≥n para realizar reservas -->
                <div id="reservas-content" class="dynamic-section hidden">
                    <h3>Reserva tu Clase</h3>
                    <p>Aqu√≠ podr√°s ver las clases disponibles y reservar tu cupo.</p>
                </div>
            </div>
        </section>

        <!-- Bot√≥n para volver al men√∫ anterior, oculto por defecto -->
        <button class="back-button hidden" id="back-button">
            <span>‚Üê Volver</span>
        </button>
    </main>

    <!-- Pie de p√°gina -->
    <footer class="footer">
        <p>&copy; 2024 PowerGym. Todos los derechos reservados.</p>
    </footer>

    <!-- Widget del Chatbot -->
    <!-- Burbuja flotante para abrir el chatbot -->
    <div id="chatbot-bubble">
        <span>üí¨</span>
    </div>

    <!-- Contenedor principal del widget del chatbot, oculto por defecto -->
    <div id="chatbot-widget-container" class="hidden">
        <div class="chat-container">
            <!-- Cabecera del chat -->
            <div class="chat-header">
                <div class="bot-avatar">ü§ñ</div>
                <h3>Asistente Virtual</h3>
                <div class="bot-status">En l√≠nea ‚Ä¢ Responde en segundos</div>
            </div>

            <!-- √Årea de mensajes del chat -->
            <div class="chat-messages" id="chatMessages">
                <!-- Mensaje inicial del bot -->
                <div class="message bot">
                    <div class="message-bubble">
                        ¬°Hola! Soy tu asistente virtual. ¬øEn qu√© puedo ayudarte hoy?
                    </div>
                </div>
                <!-- Respuestas r√°pidas para el usuario -->
                <div class="quick-responses">
                    <div class="quick-response" onclick="sendQuickMessage('¬øQu√© servicios ofrecen?')">Servicios</div>
                    <div class="quick-response" onclick="sendQuickMessage('¬øCu√°les son sus horarios?')">Horarios</div>
                    <div class="quick-response" onclick="sendQuickMessage('¬øC√≥mo los contacto?')">Contacto</div>
                </div>
            </div>

            <!-- Indicador de que el bot est√° escribiendo -->
            <div class="typing-indicator" id="typingIndicator">
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>

            <!-- Entrada de texto para que el usuario escriba su mensaje -->
            <div class="chat-input-container">
                <div class="input-group">
                    <input type="text" id="chatInput" placeholder="Escribe tu mensaje aqu√≠..." maxlength="500">
                    <button id="sendButton" onclick="sendMessage()">‚û§</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts de JavaScript -->
    <script src="js/script.js"></script> <!-- Script para la funcionalidad general de la interfaz (men√∫s, etc.) -->
    <script src="js/funciones.js"></script> <!-- Script con funciones auxiliares o adicionales -->
    <!-- Chatbot Scripts -->
    <script src="chatbot/js/funciones.js"></script> <!-- Script para la l√≥gica interna del chatbot -->
    <script src="js/chatbot-integration.js"></script> <!-- Script para integrar el chatbot con la p√°gina principal -->

    <!-- Script en l√≠nea para manejar el estado de la sesi√≥n del usuario -->
    <script>
        // Se ejecuta cuando el contenido del DOM ha sido completamente cargado.
        document.addEventListener('DOMContentLoaded', function() {
            // Referencias a los elementos del DOM para el manejo de la sesi√≥n.
            const loginButton = document.getElementById('login-button');
            const loggedInSection = document.getElementById('logged-in-section');
            const welcomeMessage = document.getElementById('welcome-message');
            const logoutButton = document.getElementById('logout-btn');

            // Ocultar ambos contenedores por defecto para evitar parpadeos mientras se verifica la sesi√≥n.
            loginButton.style.display = 'none';
            loggedInSection.style.display = 'none';

            // Petici√≥n a la API para verificar si el usuario ha iniciado sesi√≥n.
            fetch('api/verificar_sesion.php')
                .then(response => response.json()) // Convierte la respuesta a JSON.
                .then(data => {
                    if (data.logueado) { // Si el usuario est√° logueado.
                        // Muestra un mensaje de bienvenida y la secci√≥n de usuario logueado.
                        welcomeMessage.textContent = `¬°Hola ${data.email}, esperamos que disfrutes tu experiencia!`;
                        loggedInSection.style.display = 'flex';
                        loginButton.style.display = 'none';

                        // Ocultar el mensaje de bienvenida despu√©s de 5 segundos con un efecto de desvanecimiento.
                        setTimeout(() => {
                            welcomeMessage.style.opacity = '0';
                            setTimeout(() => {
                                welcomeMessage.style.display = 'none';
                            }, 500); // Coincide con la duraci√≥n de la transici√≥n CSS.
                        }, 5000); // 5 segundos.
                    } else { // Si el usuario no est√° logueado.
                        // Muestra el bot√≥n de "Iniciar Sesi√≥n".
                        loginButton.style.display = 'block';
                        loggedInSection.style.display = 'none';
                    }
                })
                .catch(error => { // En caso de error en la petici√≥n.
                    console.error('Error al verificar la sesi√≥n:', error);
                    // Muestra el bot√≥n de "Iniciar Sesi√≥n" como opci√≥n segura por defecto.
                    loginButton.style.display = 'block';
                    loggedInSection.style.display = 'none';
                });

            // A√±ade un listener al bot√≥n de "Cerrar Sesi√≥n".
            logoutButton.addEventListener('click', function(e) {
                e.preventDefault(); // Previene la acci√≥n por defecto del enlace.
                window.location.href = 'logout.php?origen=index'; // Redirige a la p√°gina de logout.
            });
        });
    </script>
</body>
</html>